webpackJsonp([1],{"0nHE":function(t,a,i){"use strict";var e=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"m-index"},[i("mt-search",{model:{value:t.value,callback:function(a){t.value=a},expression:"value"}}),t._v(" "),i("div",{staticClass:"index-swipe"},[i("mt-swipe",{attrs:{auto:0}},t._l(t.imgs,function(t){return i("mt-swipe-item",[i("img",{attrs:{src:t}})])}))],1),t._v(" "),i("div",{staticClass:"m-grid"},[i("h4",[t._v("推荐歌单")]),t._v(" "),i("ul",{staticClass:"grid-ul"},t._l(t.medias,function(a){return i("li",{on:{click:function(i){t.goPlayList(a.id)}}},[i("img",{staticClass:"coverimg",attrs:{src:a.picUrl}}),t._v(" "),i("p",{staticClass:"title"},[t._v(t._s(a.name))])])}))])],1)},n=[],s={render:e,staticRenderFns:n};a.a=s},"0sT/":function(t,a){},"42Hy":function(t,a,i){"use strict";function e(t){i("8LHV")}var n=i("DK6z"),s=i("0nHE"),o=i("VU/8"),r=e,c=o(n.a,s.a,r,"data-v-4248c56a",null);a.a=c.exports},"5awb":function(t,a,i){"use strict";var e=i("Dd8w"),n=i.n(e),s=i("NYxO"),o=i("gyMJ"),r=i("ZoQJ");a.a={name:"Media",data:function(){return{id:this.$route.params.id,item:{},end:0,start:0,isRangeChanging:!1,favFlag:!1}},computed:n()({duration:{get:function(){return r.a.FormatTime(this.end)},set:function(t){this.end=t}},startTime:function(){return r.a.FormatTime(this.$store.state.playingTime)},valueRange:function(){return this.isRangeChanging?this.$el.querySelector(".range").value:this.$store.state.playingTime}},i.i(s.b)(["playingTime","playMode","isPlaylistShow","currentId"])),methods:{initNav:function(){this.$store.commit("setNavShow",!0),this.$store.commit("setNavState",1)},getMusic:function(t){var a=this;o.a.getSongDetail(t).then(function(i){if(i.data[t]){var e=i.data[t].songs[0];a.item={name:e.name,id:e.id,dt:e.dt/1e3,picUrl:e.al.picUrl},a.end=a.item.dt,a.$store.commit("setCurrentId",t),a.$store.dispatch("updatePlayList",{item:a.item})}else alert("无源")})},onEvent:function(){},isChanging:function(){this.isRangeChanging=!0},changeValue:function(){this.isRangeChanging=!1;var t=this.$el.querySelector(".range").value;this.$store.dispatch("changePlayingTime",{time:t,flag:!0})},changePlayMode:function(){var t=this.playMode,a=++t%3;this.$store.commit("setPlayMode",a)},showPlaylist:function(){this.$store.commit("setPlaylistShow",!this.isPlaylistShow)},addFav:function(){this.favFlag=!this.favFlag}},watch:{currentId:function(t,a){t!=a&&(this.$router.replace({name:"Media",params:{id:t}}),this.getMusic(t))},$route:function(t,a){console.log(t)}},mounted:function(){this.initNav(),this.getMusic(this.id),this.onEvent()}}},"5gq+":function(t,a,i){"use strict";var e=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{attrs:{id:"app"}},[i("center",[i("router-view")],1),t._v(" "),i("player-nav")],1)},n=[],s={render:e,staticRenderFns:n};a.a=s},"8LHV":function(t,a){},"9CA8":function(t,a){},BF2F:function(t,a,i){"use strict";var e=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"m-playlist"},[i("div",{staticClass:"info"},[i("img",{attrs:{src:t.playList.coverImgUrl}}),t._v(" "),i("div",{staticClass:"cont"},[i("h5",[t._v(t._s(t.playList.name))])])]),t._v(" "),i("div",{staticClass:"list-wrap"},[i("p",[t._v("歌曲列表")]),t._v(" "),i("ul",{staticClass:"list"},t._l(t.playList.tracks,function(a){return i("li",[i("router-link",{attrs:{to:{name:"Media",params:{id:a.id}}}},[t._v(t._s(a.name))]),t._v(" "),i("i",{staticClass:"iconfont icon-play",on:{click:function(i){i.stopPropagation(),t.updatePlaylist(a)}}})],1)}))])])},n=[],s={render:e,staticRenderFns:n};a.a=s},BNXJ:function(t,a){},DK6z:function(t,a,i){"use strict";var e=i("gyMJ");a.a={name:"Index",data:function(){return{value:"",imgs:["http://wx1.sinaimg.cn/mw690/006fcAFqgy1fj3auw1ej2j31hc0s9tt0.jpg","http://wx3.sinaimg.cn/mw690/006fcAFqgy1fj3aumri94j31gf0ti4j9.jpg","http://wx2.sinaimg.cn/mw690/006fcAFqgy1fj3av3os0vj31ev0sadza.jpg"],medias:[]}},methods:{goPlayList:function(t){this.$router.push({path:"/PlayList?id="+t})},initNav:function(){this.$store.commit("setNavShow",!1)},getMusics:function(){var t=this;e.a.getPersonalizedPlaylist().then(function(a){200===a.data.code&&(t.medias=a.data.result)},function(t){console.log("error")})}},create:function(){this.initNav()},mounted:function(){this.getMusics()}}},Fs8J:function(t,a,i){"use strict";a.a={name:"home",data:function(){return{}},methods:{initNav:function(){this.$store.commit("setNavShow",!0),this.$store.commit("setNavState",0)}},mounted:function(){this.initNav()}}},GtXq:function(t,a){},IcnI:function(t,a,i){"use strict";var e=i("mvHQ"),n=i.n(e),s=i("7+uW"),o=i("NYxO");i("gyMJ");s.default.use(o.a);var r=new o.a.Store({state:{navShow:!1,navState:0,isPlaying:!1,isPlaylistShow:!1,playList:[],playMode:0,playingTime:0,isNextOrPrev:!1,changeFlag:!1,duration:0,currentId:null,currentMedia:{}},getters:{navShow:function(t){return t.navShow},navState:function(t){return t.navState},isPlaylistShow:function(t){return t.isPlaylistShow},isPlaying:function(t){return t.isPlaying},playList:function(t){return t.playList},playMode:function(t){return t.playMode},playingTime:function(t){return t.playingTime},isNextOrPrev:function(t){return t.isNextOrPrev},changeFlag:function(t){return t.changeFlag},duration:function(t){return t.duration},currentId:function(t){return t.currentId},currentMedia:function(t){return t.currentMedia}},mutations:{setNavShow:function(t,a){t.navShow=a},setNavState:function(t,a){t.navState=a},setPlaylistShow:function(t,a){t.isPlaylistShow=a},setIsPlaying:function(t,a){t.isPlaying=a},setPlayMode:function(t,a){t.playMode=a},setPlayingTime:function(t,a){t.playingTime=a},setIsNextOrPrev:function(t,a){t.isNextOrPrev=a},setChangeFlag:function(t,a){t.changeFlag=a},setCurrentId:function(t,a){t.currentId=a},setCurrentMedia:function(t,a){t.currentMedia=a},setPlayList:function(t,a){if(0==t.playList.length)t.playList.push(a);else{var i=!1;t.playList.forEach(function(t,e){t.id===a.id&&(i=!0)}),i||t.playList.push(a)}},setLocalPlayList:function(t,a){t.playList=a}},actions:{changePlayingTime:function(t,a){var i=t.commit,e=(t.state,a.time),n=a.flag;i("setPlayingTime",e),i("setChangeFlag",n)},changeCurrentId:function(t,a){var i=t.commit;t.state;i("setCurrentId",a.id),i("setIsNextOrPrev",!1)},initLocalPlayList:function(t){var a=t.commit,i=(t.state,window.localStorage.getItem("localList"));i=i||[],a("setLocalPlayList",JSON.parse(i))},updatePlayList:function(t,a){var i=t.commit,e=t.state,s=a.item,o=a.opt;"add"==(void 0===o?"add":o)&&(i("setPlayList",s),window.localStorage.setItem("localList",n()(e.playList)))}}});a.a=r},LFGr:function(t,a,i){"use strict";function e(t){i("0sT/")}var n=i("XCFq"),s=i("Vl5h"),o=i("VU/8"),r=e,c=o(n.a,s.a,r,"data-v-be633b0a",null);a.a=c.exports},Lato:function(t,a){},M93x:function(t,a,i){"use strict";function e(t){i("GtXq")}var n=i("xJD8"),s=i("5gq+"),o=i("VU/8"),r=e,c=o(n.a,s.a,r,null,null);a.a=c.exports},MPzD:function(t,a){},NHnr:function(t,a,i){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e=i("7+uW"),n=i("NYxO"),s=i("Au9i"),o=i.n(s),r=i("MPzD"),c=(i.n(r),i("d8/S")),l=(i.n(c),i("M93x")),u=i("YaEn"),d=i("LFGr"),v=i("IcnI");e.default.use(n.a),e.default.use(o.a),e.default.component("player-nav",d.a),e.default.config.productionTip=!1,new e.default({el:"#app",router:u.a,store:v.a,template:"<App/>",components:{App:l.a}})},QDIx:function(t,a,i){"use strict";var e=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"m-media"},[i("div",{staticClass:"cover-wrap"},[i("img",{staticClass:"cover",attrs:{src:t.item.picUrl}})]),t._v(" "),i("h4",[t._v(t._s(t.item.name))]),t._v(" "),i("div",{staticClass:"m-range"},[i("span",[t._v(t._s(t.startTime))]),t._v(" "),i("input",{staticClass:"range",attrs:{type:"range",min:0,max:t.end},domProps:{value:t.valueRange},on:{input:t.isChanging,change:t.changeValue}}),t._v(" "),i("span",[t._v(t._s(t.duration))])]),t._v(" "),i("div",{staticClass:"options"},[i("span",{staticClass:"btn-mode",attrs:{mode:t.playMode},on:{click:t.changePlayMode}},[i("i",{directives:[{name:"show",rawName:"v-show",value:0==t.playMode,expression:"playMode==0"}],staticClass:"iconfont icon-loop"}),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:1==t.playMode,expression:"playMode==1"}],staticClass:"iconfont icon-singleloop"}),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:2==t.playMode,expression:"playMode==2"}],staticClass:"iconfont icon-random"})]),t._v(" "),i("span",{staticClass:"btn-like iconfont icon-like",class:{"z-like":t.favFlag},on:{click:t.addFav}}),t._v(" "),i("span",{staticClass:"btn-list iconfont icon-playlist",on:{click:t.showPlaylist}})])])},n=[],s={render:e,staticRenderFns:n};a.a=s},Vl5h:function(t,a,i){"use strict";var e=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("footer",{directives:[{name:"show",rawName:"v-show",value:t.navShow,expression:"navShow"}]},[i("div",{staticClass:"nav"},[i("span",{directives:[{name:"show",rawName:"v-show",value:0==t.navState,expression:"navState==0"}],staticClass:"link"},[i("router-link",{attrs:{to:"/"}},[t._v("首页")])],1),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:1==t.navState,expression:"navState==1"}],staticClass:"prevbtn",on:{click:function(a){t.playNextOrPrev(-1)}}},[i("i",{staticClass:"iconfont icon-prev"})]),t._v(" "),i("span",{staticClass:"playbtn",class:{"z-playing":t.isPlaying},on:{click:t.playOrNot}},[i("i",{staticClass:"iconfont icon-play"}),t._v(" "),i("i",{staticClass:"iconfont icon-pause"})]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:1==t.navState,expression:"navState==1"}],staticClass:"prevbtn",on:{click:function(a){t.playNextOrPrev(1)}}},[i("i",{staticClass:"iconfont icon-next"})]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:0==t.navState,expression:"navState==0"}],staticClass:"link"},[t._v("我的")])]),t._v(" "),i("div",{staticClass:"player"},[i("audio",{attrs:{src:t.audioItem.url,preload:""},on:{canplay:t.getPlayState,timeupdate:t.audioTimeUpdate,ended:t.playEnd}})]),t._v(" "),i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.isPlaylistShow,expression:"isPlaylistShow"}],staticClass:"m-playlist"},[i("div",{staticClass:"opts"},[i("span",{on:{click:t.clearPlaylist}},[t._v("清空列表")]),t._v(" "),i("span",{on:{click:t.hidePlaylist}},[t._v("关闭")])]),t._v(" "),i("ul",t._l(t.playList,function(a){return i("li",{class:{cur:a.id==t.currentId},on:{click:function(i){t.goPlay(a.id)}}},[t._v(t._s(a.name))])}))])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isPlaylistShow,expression:"isPlaylistShow"}],staticClass:"mask",on:{click:t.hidePlaylist}})],1)},n=[],s={render:e,staticRenderFns:n};a.a=s},XCFq:function(t,a,i){"use strict";var e=i("Dd8w"),n=i.n(e),s=i("NYxO"),o=i("gyMJ");a.a={name:"PlayerNav",data:function(){return{id:null,audioItem:{}}},computed:n()({},i.i(s.b)(["navState","navShow","currentId","playingTime","duration","isPlaying","playList","isPlaylistShow","playMode"])),methods:{playOrNot:function(){this.$audio.paused?this.$store.commit("setIsPlaying",!0):this.$store.commit("setIsPlaying",!1)},getDuration:function(){},getPlayState:function(){this.$store.commit("setIsPlaying",!0)},getMusicSource:function(){var t=this;if(this.$store.commit("setIsPlaying",!1),null!=this.id)return o.a.getMusicUrl(this.id).then(function(a){a.data[t.id]?t.audioItem=a.data[t.id].data[0]:alert("无源")})},onEvent:function(){},audioTimeUpdate:function(){this.$store.state.changeFlag?(this.$audio.currentTime=this.$store.state.playingTime,this.$store.commit("setChangeFlag",!1)):this.$store.commit("setPlayingTime",this.$audio.currentTime)},playEnd:function(){this.playWithList()},playWithList:function(){var t=this.$store.state.playMode,a=this.$store.state.playList;this.$store.state.currentId;switch(t){case 0:this.playNextOrPrev(1);break;case 1:this.$audio.currentTime=0,this.audioTimeUpdate(),this.$audio.play();break;case 2:var i=Math.floor(a.length*Math.random());this.$store.commit("setCurrentId",a[i].id)}},playNextOrPrev:function(t){if(!this.$store.state.isNextOrPrev){this.$store.commit("setIsNextOrPrev",!0);var a,i=this.$store.state.playList,e=this.$store.state.currentId,n=-1;i.forEach(function(a,s){if(a.id==e)return void(-1===t?n=0==s?(i.length-s-1)%i.length:--s%i.length:1==t&&(n=++s%i.length))}),a=i[n].id,this.$store.dispatch("changeCurrentId",{id:a})}},hidePlaylist:function(){this.$store.commit("setPlaylistShow",!1)},clearPlaylist:function(){alert("to do sth")},goPlay:function(t){this.$store.commit("setCurrentId",t)}},watch:{currentId:function(t,a){t!=a&&(this.id=t,this.getMusicSource())},changeFlag:function(t,a){console.log(this.playingTime)},isPlaying:function(t,a){t?(console.log("why not play"),this.$audio.play()):this.$audio.pause()}},mounted:function(){this.$audio=document.querySelector(".player audio"),this.getMusicSource(),this.onEvent()}}},YaEn:function(t,a,i){"use strict";var e=i("7+uW"),n=i("/ocq"),s=i("42Hy"),o=i("v6Uu"),r=i("lO7g"),c=i("cUHA");i("rwDq");e.default.use(n.a),a.a=new n.a({routes:[{path:"/",name:"Index",component:s.a},{path:"/Media/:id",name:"Media",component:o.a},{path:"/Home",name:"home",component:r.a},{path:"/PlayList",name:"PlayList",component:c.a}]})},ZoQJ:function(t,a,i){"use strict";a.a={FormatTime:function(t){var a=parseInt(t/60),i=parseInt(t%60);return(a>=10?""+a:"0"+a)+":"+(i>=10?""+i:"0"+i)}}},cUHA:function(t,a,i){"use strict";function e(t){i("BNXJ")}var n=i("ofsE"),s=i("BF2F"),o=i("VU/8"),r=e,c=o(n.a,s.a,r,null,null);a.a=c.exports},"d8/S":function(t,a){},gyMJ:function(t,a,i){"use strict";var e=i("mvHQ"),n=i.n(e),s=i("mtWM"),o=i.n(s);o.a.defaults.baseURL="/vueMusicDemo";a.a={getPersonalizedPlaylist:function(){return o.a.get("/static/datas/hot-list.json")},getPlaylistDetail:function(t){return o.a.get("/static/datas/list-detail.json",{params:{id:t}})},getSongDetail:function(t){return o.a.get("/static/datas/list-song.json",{params:{c:n()([{id:t}]),ids:"["+t+"]",csrf_token:""}})},getMusicUrl:function(t){return o.a.get("/static/datas/url-list.json",{params:{ids:"["+t+"]",br:999e3,csrf_token:""}})}}},jziG:function(t,a,i){"use strict";var e=function(){var t=this,a=t.$createElement;return(t._self._c||a)("div",[t._v("some strange page")])},n=[],s={render:e,staticRenderFns:n};a.a=s},lO7g:function(t,a,i){"use strict";function e(t){i("Lato")}var n=i("Fs8J"),s=i("jziG"),o=i("VU/8"),r=e,c=o(n.a,s.a,r,"data-v-6aab7614",null);a.a=c.exports},ofsE:function(t,a,i){"use strict";var e=i("gyMJ");a.a={name:"playlist",data:function(){return{id:this.$route.query.id,playList:{}}},methods:{getPlayList:function(){var t=this;e.a.getPlaylistDetail(this.id).then(function(a){t.playList=a.data[t.id].playlist})},updatePlaylist:function(t){this.$store.commit("setCurrentId",t.id),this.$store.dispatch("updatePlayList",{item:{name:t.name,id:t.id,dt:t.dt/1e3,picUrl:t.al.picUrl}}),this.$store.commit("setNavShow",!0),this.$store.commit("setNavState",1)}},computed:{},mounted:function(){this.getPlayList()}}},rwDq:function(t,a,i){"use strict";var e=i("VU/8"),n=e(null,null,null,null,null);n.exports},v6Uu:function(t,a,i){"use strict";function e(t){i("9CA8")}var n=i("5awb"),s=i("QDIx"),o=i("VU/8"),r=e,c=o(n.a,s.a,r,"data-v-e2dbe946",null);a.a=c.exports},xJD8:function(t,a,i){"use strict";a.a={name:"app",created:function(){this.$store.dispatch("initLocalPlayList")}}}},["NHnr"]);
//# sourceMappingURL=app.1f8bcecd11304e53ee71.js.map