webpackJsonp([1],{"+OuC":function(t,i){},"3yP3":function(t,i,e){"use strict";var a=!1,n=function(t,i){t.addEventListener("touchstart",function(t){if(a)return!1;i.start(event.changedTouches[0]||event.touches[0]),a=!0}),t.addEventListener("touchmove",function(t){i.move(event.changedTouches[0]||event.touches[0])}),t.addEventListener("touchend",function(t){i.end(event.changedTouches[0]||event.touches[0]),a=!1})};i.a=n},"42Hy":function(t,i,e){"use strict";function a(t){e("m9qv")}var n=e("DK6z"),s=e("6TWI"),o=e("VU/8"),r=a,c=o(n.a,s.a,r,"data-v-3a8d0714",null);i.a=c.exports},"5awb":function(t,i,e){"use strict";var a=e("Dd8w"),n=e.n(a),s=e("V9qW"),o=e("NYxO"),r=e("gyMJ"),c=e("ZoQJ");i.a={name:"Media",components:{"my-progress-bar":s.a},data:function(){return{id:this.$route.params.id,item:{},end:0,start:0,favFlag:!1}},computed:n()({duration:{get:function(){return c.a.FormatTime(this.end)},set:function(t){this.end=t}},startTime:function(){return c.a.FormatTime(this.$store.state.playingTime)},valueRange:function(){return this.$store.state.playingTime}},e.i(o.b)(["playingTime","playMode","isPlaylistShow","currentId"])),methods:{initNav:function(){this.$store.commit("setnavLeftShow",!1)},getMusic:function(t){var i=this;r.a.getSongDetail(t).then(function(e){if(e.data[t]){var a=e.data[t].songs[0];i.item={name:a.name,id:a.id,dt:a.dt/1e3,picUrl:a.al.picUrl},i.end=i.item.dt,i.$store.commit("setCurrentId",t),i.$store.dispatch("updatePlayList",{item:i.item})}else alert("无源")})},onEvent:function(){},changeValue:function(t){this.$store.dispatch("changePlayingTime",{time:t,flag:!0})},changePlayMode:function(){var t=this.playMode,i=++t%3;this.$store.commit("setPlayMode",i)},showPlaylist:function(){this.$store.commit("setPlaylistShow",!this.isPlaylistShow)},addFav:function(){this.favFlag=!this.favFlag}},watch:{currentId:function(t,i){t!=i&&(this.$router.replace({name:"Media",params:{id:t}}),this.getMusic(t))},$route:function(t,i){}},mounted:function(){this.initNav(),this.getMusic(this.id),this.onEvent()}}},"6TWI":function(t,i,e){"use strict";var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"m-index"},[e("mt-search",{model:{value:t.value,callback:function(i){t.value=i},expression:"value"}}),t._v(" "),e("div",{staticClass:"index-swipe"},[e("mt-swipe",{attrs:{auto:0}},t._l(t.imgs,function(t){return e("mt-swipe-item",[e("img",{attrs:{src:t}})])}))],1),t._v(" "),e("div",{staticClass:"m-grid"},[e("h4",[t._v("推荐歌单")]),t._v(" "),e("ul",{staticClass:"grid-ul"},t._l(t.medias,function(i){return e("li",{on:{click:function(e){t.goPlayList(i.id)}}},[e("img",{staticClass:"coverimg",attrs:{src:i.picUrl}}),t._v(" "),e("p",{staticClass:"title"},[t._v(t._s(i.name))])])}))])],1)},n=[],s={render:a,staticRenderFns:n};i.a=s},"8vpT":function(t,i,e){"use strict";var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("footer",{directives:[{name:"show",rawName:"v-show",value:t.navShow,expression:"navShow"}]},[e("div",{staticClass:"nav"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.navLeftShow,expression:"navLeftShow"}],staticClass:"item leftnav"},[e("i",{staticClass:"iconfont icon-playlist",on:{click:function(i){t.togglePlaylist()}}}),t._v(" "),e("span",[t._v(t._s(t.currentSong.name))])]),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:0==t.navState,expression:"navState==0"}],staticClass:"link item"},[e("router-link",{attrs:{to:"/"}},[t._v("首页")])],1),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:1==t.navState,expression:"navState==1"}],staticClass:"prevbtn item",on:{click:function(i){t.playNextOrPrev(-1)}}},[e("i",{staticClass:"iconfont icon-prev"})]),t._v(" "),e("span",{staticClass:"playbtn item",class:{"z-playing":t.isPlaying},on:{click:t.playOrNot}},[e("i",{staticClass:"iconfont icon-play"}),t._v(" "),e("i",{staticClass:"iconfont icon-pause"})]),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:1==t.navState,expression:"navState==1"}],staticClass:"prevbtn item",on:{click:function(i){t.playNextOrPrev(1)}}},[e("i",{staticClass:"iconfont icon-next"})]),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:0==t.navState,expression:"navState==0"}],staticClass:"link item"},[t._v("我的")])]),t._v(" "),e("div",{staticClass:"player"},[e("audio",{attrs:{src:t.audioItem.url,preload:""},on:{canplay:t.getPlayState,timeupdate:t.audioTimeUpdate,ended:t.playEnd}})]),t._v(" "),e("transition",{attrs:{name:"fade"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isPlaylistShow,expression:"isPlaylistShow"}],staticClass:"m-playlist"},[e("div",{staticClass:"opts"},[e("span",{on:{click:t.clearPlaylist}},[t._v("清空列表")]),t._v(" "),e("span",{on:{click:t.hidePlaylist}},[t._v("关闭")])]),t._v(" "),t.playList.length>0?e("ul",t._l(t.playList,function(i){return e("li",{class:{cur:i.id==t.currentId},on:{click:function(e){t.goPlay(i)}}},[t._v(t._s(i.name))])})):t._e(),t._v(" "),t.playList.length<=0?e("div",{staticClass:"tip-empty"},[t._v("\n\t\t\t\t~暂未添加歌曲~\n\t\t\t")]):t._e()])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isPlaylistShow,expression:"isPlaylistShow"}],staticClass:"mask",on:{click:t.hidePlaylist}})],1)},n=[],s={render:a,staticRenderFns:n};i.a=s},"99yD":function(t,i,e){"use strict";var a=function(){var t=this,i=t.$createElement;return(t._self._c||i)("div",[t._v("some strange page")])},n=[],s={render:a,staticRenderFns:n};i.a=s},AYXl:function(t,i,e){"use strict";var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"m-progress-bar"},[e("div",{staticClass:"twrap"},[t._t("tStart")],2),t._v(" "),e("div",{ref:"bar",staticClass:"bar",attrs:{"data-min":t.min,"data-max":t.max,"data-per":t.rangePercent}},[e("div",{staticClass:"cur",style:{width:t.rangePercent}},[e("span",{ref:"cur",staticClass:"ico-cur"})])]),t._v(" "),e("div",{staticClass:"twrap"},[t._t("tEnd")],2)])},n=[],s={render:a,staticRenderFns:n};i.a=s},DK6z:function(t,i,e){"use strict";var a=e("gyMJ");i.a={name:"Index",data:function(){return{value:"",imgs:["http://wx1.sinaimg.cn/mw690/006fcAFqgy1fj3auw1ej2j31hc0s9tt0.jpg","http://wx3.sinaimg.cn/mw690/006fcAFqgy1fj3aumri94j31gf0ti4j9.jpg","http://wx2.sinaimg.cn/mw690/006fcAFqgy1fj3av3os0vj31ev0sadza.jpg"],medias:[]}},methods:{goPlayList:function(t){this.$router.push({path:"/PlayList?id="+t})},initNav:function(){this.$store.commit("setnavLeftShow",!0)},getMusics:function(){var t=this;a.a.getPersonalizedPlaylist().then(function(i){200===i.data.code&&(t.medias=i.data.result)},function(t){console.log("error")})}},mounted:function(){this.getMusics(),this.initNav()}}},Fs8J:function(t,i,e){"use strict";i.a={name:"home",data:function(){return{}},methods:{initNav:function(){this.$store.commit("setNavShow",!0),this.$store.commit("setNavState",0)}},mounted:function(){this.initNav()}}},IcnI:function(t,i,e){"use strict";var a=e("mvHQ"),n=e.n(a),s=e("7+uW"),o=e("NYxO");e("gyMJ");s.default.use(o.a);var r=new o.a.Store({state:{navShow:!1,navState:1,navLeftShow:!0,isPlaying:!1,isPlaylistShow:!1,playList:[],playMode:0,playingTime:0,isNextOrPrev:!1,changeFlag:!1,duration:0,currentId:null,currentSong:{}},getters:{navShow:function(t){return t.navShow},navState:function(t){return t.navState},navLeftShow:function(t){return t.navLeftShow},isPlaylistShow:function(t){return t.isPlaylistShow},isPlaying:function(t){return t.isPlaying},playList:function(t){return t.playList},playMode:function(t){return t.playMode},playingTime:function(t){return t.playingTime},isNextOrPrev:function(t){return t.isNextOrPrev},changeFlag:function(t){return t.changeFlag},duration:function(t){return t.duration},currentId:function(t){return t.currentId},currentSong:function(t){return t.currentSong}},mutations:{setNavShow:function(t,i){t.navShow=i},setNavState:function(t,i){t.navState=i},setnavLeftShow:function(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.navLeftShow=i},setPlaylistShow:function(t,i){t.isPlaylistShow=i},togglePlaylistShow:function(t){t.isPlaylistShow=!t.isPlaylistShow},setIsPlaying:function(t,i){t.isPlaying=i},setPlayMode:function(t,i){t.playMode=i},setPlayingTime:function(t,i){t.playingTime=i},setIsNextOrPrev:function(t,i){t.isNextOrPrev=i},setChangeFlag:function(t,i){t.changeFlag=i},setCurrentId:function(t,i){t.currentId=i},setCurrentSong:function(t,i){t.currentSong=i},setPlayList:function(t,i){if(0==t.playList.length)t.playList.push(i);else{var e=!1;t.playList.forEach(function(t,a){t.id===i.id&&(e=!0)}),e||t.playList.push(i)}},emptyPlayList:function(t){t.playList=[]},setLocalPlayList:function(t,i){t.playList=i}},actions:{changePlayingTime:function(t,i){var e=t.commit,a=(t.state,i.time),n=i.flag;e("setPlayingTime",a),e("setChangeFlag",n)},changeCurrentId:function(t,i){var e=t.commit,a=(t.state,i.item);e("setPlayingTime",0),e("setCurrentId",a.id),e("setCurrentSong",a),e("setIsNextOrPrev",!1)},initLocalPlayList:function(t){var i,e=t.commit,a=t.state,n=window.localStorage.getItem("localList");n="[null]"!=n&&null!=n?n:"[]",i=JSON.parse(n),e("setLocalPlayList",i),i.length>0?e("setNavShow",!0):e("setNavShow",!1),a.isPlaying||null==a.currentId&&a.playList.length>0&&(e("setCurrentSong",a.playList[0]),e("setCurrentId",a.currentSong.id))},updatePlayList:function(t,i){var e=t.commit,a=t.state,s=i.item,o=i.opt;"add"==(void 0===o?"add":o)&&(e("setPlayList",s),window.localStorage.setItem("localList",n()(a.playList)))},clearPlaylist:function(t){var i=t.commit;t.state;i("emptyPlayList"),window.localStorage.setItem("localList",n()([]))}}});i.a=r},LFGr:function(t,i,e){"use strict";function a(t){e("eno3")}var n=e("XCFq"),s=e("8vpT"),o=e("VU/8"),r=a,c=o(n.a,s.a,r,"data-v-91fa97b4",null);i.a=c.exports},M93x:function(t,i,e){"use strict";function a(t){e("f6eo")}var n=e("xJD8"),s=e("pu8k"),o=e("VU/8"),r=a,c=o(n.a,s.a,r,null,null);i.a=c.exports},MPzD:function(t,i){},NHnr:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e("7+uW"),n=e("NYxO"),s=e("Au9i"),o=e.n(s),r=e("MPzD"),c=(e.n(r),e("d8/S")),l=(e.n(c),e("M93x")),u=e("YaEn"),d=e("LFGr"),v=e("IcnI");a.default.use(n.a),a.default.use(o.a),a.default.component("player-nav",d.a),a.default.config.productionTip=!1,new a.default({el:"#app",router:u.a,store:v.a,template:"<App/>",components:{App:l.a}})},Rxj9:function(t,i){},"T/Z3":function(t,i,e){"use strict";var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"m-media"},[e("div",{staticClass:"cover-wrap"},[e("img",{staticClass:"cover",attrs:{src:t.item.picUrl}})]),t._v(" "),e("h4",[t._v(t._s(t.item.name))]),t._v(" "),e("my-progress-bar",{attrs:{min:0,max:t.end},on:{changeValue:t.changeValue},model:{value:t.valueRange,callback:function(i){t.valueRange=i},expression:"valueRange"}},[e("span",{slot:"tStart"},[t._v(t._s(t.startTime))]),t._v(" "),e("span",{slot:"tEnd"},[t._v(t._s(t.duration))])]),t._v(" "),e("div",{staticClass:"options"},[e("span",{staticClass:"btn-mode",attrs:{mode:t.playMode},on:{click:t.changePlayMode}},[e("i",{directives:[{name:"show",rawName:"v-show",value:0==t.playMode,expression:"playMode==0"}],staticClass:"iconfont icon-loop"}),t._v(" "),e("i",{directives:[{name:"show",rawName:"v-show",value:1==t.playMode,expression:"playMode==1"}],staticClass:"iconfont icon-singleloop"}),t._v(" "),e("i",{directives:[{name:"show",rawName:"v-show",value:2==t.playMode,expression:"playMode==2"}],staticClass:"iconfont icon-random"})]),t._v(" "),e("span",{staticClass:"btn-like iconfont icon-like",class:{"z-like":t.favFlag},on:{click:t.addFav}}),t._v(" "),e("span",{staticClass:"btn-list iconfont icon-playlist",on:{click:t.showPlaylist}})])],1)},n=[],s={render:a,staticRenderFns:n};i.a=s},V9qW:function(t,i,e){"use strict";function a(t){e("Rxj9")}var n=e("mpSs"),s=e("AYXl"),o=e("VU/8"),r=a,c=o(n.a,s.a,r,"data-v-0fb6625c",null);i.a=c.exports},XCFq:function(t,i,e){"use strict";var a=e("Dd8w"),n=e.n(a),s=e("NYxO"),o=e("gyMJ");i.a={name:"PlayerNav",data:function(){return{id:null,audioItem:{},isArrawChanging:!1}},computed:n()({},e.i(s.b)(["navState","navShow","currentId","playingTime","duration","isPlaying","playList","isPlaylistShow","playMode","currentSong","navLeftShow"]),{getCurrentName:{get:function(){var t=this,i="";return this.playList.length>0&&(null!=this.currentId?this.playList.forEach(function(e,a){if(e.id==t.currentId)return void(i=e.name)}):i=this.playList[0].name),i},set:function(){}}}),methods:{playOrNot:function(){null==this.currentId?this.playList.length:this.$audio.paused?this.$store.commit("setIsPlaying",!0):this.$store.commit("setIsPlaying",!1)},getDuration:function(){},getPlayState:function(){var t=this;this.$store.commit("setIsPlaying",!1),setTimeout(function(){t.$store.commit("setIsPlaying",!0)},0)},getMusicSource:function(){var t=this;if(this.$store.commit("setIsPlaying",!1),null!=this.currentId)return o.a.getMusicUrl(this.currentId).then(function(i){i.data[t.id]?t.audioItem=i.data[t.id].data[0]:alert("无源")})},onEvent:function(){},audioTimeUpdate:function(){this.$store.state.changeFlag?(this.$audio.currentTime=this.$store.state.playingTime,this.$store.commit("setChangeFlag",!1)):this.$store.commit("setPlayingTime",this.$audio.currentTime)},playEnd:function(){this.playList.length>1?this.playWithList():this.replay()},playWithList:function(){var t=this.$store.state.playMode,i=this.$store.state.playList;this.$store.state.currentId;switch(t){case 0:this.playNextOrPrev(1);break;case 1:this.replay();break;case 2:var e=Math.floor(i.length*Math.random());this.$store.commit("setCurrentId",i[e].id)}},playNextOrPrev:function(t){if(null==this.currentId)return!1;if(this.playList.length<=1)return!1;if(!this.isArrawChanging){this.isArrawChanging=!0;var i=this.$store.state.playList,e=this.$store.state.currentId,a=-1,n=void 0;i.forEach(function(n,s){if(n.id==e)return void(-1===t?a=0==s?(i.length-s-1)%i.length:--s%i.length:1==t&&(a=++s%i.length))}),i[a].id,n=i[a],this.$store.dispatch("changeCurrentId",{item:n}),this.isPlaying||(this.isArrawChanging=!1)}},replay:function(){var t=this;this.$store.commit("setIsPlaying",!1),this.$audio.currentTime=0,this.audioTimeUpdate(),setTimeout(function(){t.$store.commit("setIsPlaying",!0)},0)},hidePlaylist:function(){this.$store.commit("setPlaylistShow",!1)},togglePlaylist:function(){this.$store.commit("togglePlaylistShow")},clearPlaylist:function(){this.$store.dispatch("clearPlaylist")},goPlay:function(t){this.$store.commit("setCurrentId",t.id),this.$store.commit("setCurrentSong",t)}},watch:{currentId:function(t,i){t!=i&&(this.id=t,this.getMusicSource())},changeFlag:function(t,i){console.log(this.playingTime)},isPlaying:function(t,i){t?(this.isArrawChanging=!1,console.log("why not play"),this.$audio.play()):this.$audio.pause()},playList:function(t,i){this.$store.commit("setNavShow",1)}},mounted:function(){this.$audio=document.querySelector(".player audio"),this.getMusicSource(),this.onEvent()}}},YaEn:function(t,i,e){"use strict";var a=e("7+uW"),n=e("/ocq"),s=e("42Hy"),o=e("v6Uu"),r=e("lO7g"),c=e("cUHA");a.default.use(n.a),i.a=new n.a({routes:[{path:"/",name:"Index",component:s.a},{path:"/Media/:id",name:"Media",component:o.a},{path:"/Home",name:"home",component:r.a},{path:"/PlayList",name:"PlayList",component:c.a}]})},ZKyX:function(t,i){},ZoQJ:function(t,i,e){"use strict";i.a={FormatTime:function(t){var i=parseInt(t/60),e=parseInt(t%60);return(i>=10?""+i:"0"+i)+":"+(e>=10?""+e:"0"+e)}}},cUHA:function(t,i,e){"use strict";function a(t){e("+OuC")}var n=e("ofsE"),s=e("mNiQ"),o=e("VU/8"),r=a,c=o(n.a,s.a,r,null,null);i.a=c.exports},"d8/S":function(t,i){},eno3:function(t,i){},f6eo:function(t,i){},gyMJ:function(t,i,e){"use strict";var a=e("mvHQ"),n=e.n(a),s=e("//Fk"),o=e.n(s),r=e("mtWM"),c=e.n(r);c.a.defaults.baseURL="/vueMusicDemo";c.a.interceptors.response.use(function(t){return 200==t.status?t:(alert(t.status),o.a.reject(t))},function(t){return alert("请求出错"),o.a.reject(t)}),i.a={getPersonalizedPlaylist:function(){return c.a.get("/static/datas/hot-list.json")},getPlaylistDetail:function(t){return c.a.get("/static/datas/list-detail.json",{params:{id:t}})},getSongDetail:function(t){return c.a.get("/static/datas/list-song.json",{params:{c:n()([{id:t}]),ids:"["+t+"]",csrf_token:""}})},getMusicUrl:function(t){return c.a.get("/static/datas/url-list.json",{params:{ids:"["+t+"]",br:999e3,csrf_token:""}})}}},lO7g:function(t,i,e){"use strict";function a(t){e("q1vD")}var n=e("Fs8J"),s=e("99yD"),o=e("VU/8"),r=a,c=o(n.a,s.a,r,"data-v-4963572a",null);i.a=c.exports},m9qv:function(t,i){},mNiQ:function(t,i,e){"use strict";var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"m-playlist"},[e("div",{staticClass:"info"},[e("img",{attrs:{src:t.playList.coverImgUrl}}),t._v(" "),e("div",{staticClass:"cont"},[e("h5",[t._v(t._s(t.playList.name))])])]),t._v(" "),e("div",{staticClass:"list-wrap"},[e("p",[t._v("歌曲列表")]),t._v(" "),e("ul",{staticClass:"list"},t._l(t.playList.tracks,function(i){return e("li",[e("router-link",{attrs:{to:{name:"Media",params:{id:i.id}}}},[t._v(t._s(i.name))]),t._v(" "),e("i",{staticClass:"iconfont icon-play",class:{"z-cur":i.id==t.currentId},on:{click:function(e){e.stopPropagation(),t.updatePlaylist(i)}}})],1)}))])])},n=[],s={render:a,staticRenderFns:n};i.a=s},mpSs:function(t,i,e){"use strict";var a=e("3yP3");i.a={data:function(){return{test:!1}},props:{min:{type:Number,default:0},max:{type:Number,default:100},rangeValue:{default:0},value:{default:0}},computed:{rangePercent:function(){return this.value/this.max*100+"%"}},watch:{},methods:{},mounted:function(){var t=this,i=this.$refs.cur,n=this.$refs.bar,s={};e.i(a.a)(i,{start:function(t){s={mouseX:t.clientX,curX:i.getBoundingClientRect().left-n.getBoundingClientRect().left}},end:function(t){s={}},move:function(e){var a=n.clientWidth,o=e.clientX-s.mouseX+s.curX,r=o/a*100;r>=100?r=100:r<=0&&(r=0),i.parentNode.style="width: "+r+"%",t.$emit("changeValue",Math.ceil(r*t.max/100))}})}}},ofsE:function(t,i,e){"use strict";var a=e("Dd8w"),n=e.n(a),s=e("gyMJ"),o=e("NYxO");i.a={name:"playlist",data:function(){return{id:this.$route.query.id,playList:{}}},methods:{initNav:function(){this.$store.commit("setnavLeftShow",!0)},getPlayList:function(){var t=this;s.a.getPlaylistDetail(this.id).then(function(i){t.playList=i.data[t.id].playlist})},updatePlaylist:function(t){this.$store.commit("setCurrentId",t.id),this.$store.commit("setCurrentSong",t),this.$store.dispatch("updatePlayList",{item:{name:t.name,id:t.id,dt:t.dt/1e3,picUrl:t.al.picUrl}})}},computed:n()({},e.i(o.b)(["currentId"])),mounted:function(){this.getPlayList(),this.initNav()}}},pu8k:function(t,i,e){"use strict";var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{attrs:{id:"app"}},[e("center",[e("router-view")],1),t._v(" "),e("player-nav")],1)},n=[],s={render:a,staticRenderFns:n};i.a=s},q1vD:function(t,i){},v6Uu:function(t,i,e){"use strict";function a(t){e("ZKyX")}var n=e("5awb"),s=e("T/Z3"),o=e("VU/8"),r=a,c=o(n.a,s.a,r,"data-v-db202af0",null);i.a=c.exports},xJD8:function(t,i,e){"use strict";i.a={name:"app",created:function(){this.$store.dispatch("initLocalPlayList")}}}},["NHnr"]);
//# sourceMappingURL=app.344ca551db61bd578dbb.js.map